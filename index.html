<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Responsive Hesap Makinesi</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --bg-cream: #FFF3E0;
            --border-orange: #FE9800;
            --calc-bg: #0f172a;
            --screen-bg: #1e293b;
            --btn-dark: #334155;
            --btn-orange: #f97316;
            --btn-red: #dc2626;
            --btn-blue: #2563eb;
            --text-white: #f8fafc;
            --text-gray: #94a3b8;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: var(--bg-cream);
            font-family: 'Inter', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden; /* Sayfa kaymasını engelle */
        }

        .wrapper {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* --- HESAP MAKİNESİ GÖVDESİ --- */
        .calculator {
            background-color: var(--calc-bg);
            padding: 20px;
            border-radius: 24px;
            border: 2px solid var(--border-orange);
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            width: 340px;
            position: relative;
            z-index: 20; /* Hesap makinesi her zaman en üstte */
            transition: width 0.3s ease;
        }

        /* Bilimsel Mod Genişliği */
        .calculator.scientific { width: 550px; }

        /* --- GEÇMİŞ PANELİ (MASAÜSTÜ AYARLARI) --- */
        .history-panel {
            position: absolute;
            top: 0;
            right: 0; 
            width: 300px;
            height: 100%;
            background-color: #1e293b;
            border-radius: 24px;
            border: 2px solid var(--border-orange);
            padding: 20px;
            display: flex;
            flex-direction: column;
            z-index: 10; /* Hesap makinesinin arkasında */
            
            /* Animasyon Mantığı */
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275), opacity 0.3s;
            transform: translateX(0) scale(0.9); /* Başlangıçta makinenin arkasında */
            opacity: 0;
            pointer-events: none; /* Kapalıyken tıklanamaz */
        }

        /* Panel AÇIKKEN (Masaüstü) */
        .history-panel.open {
            transform: translateX(105%) scale(1); /* Sağa doğru kayar */
            opacity: 1;
            pointer-events: all;
        }

        /* --- DİĞER STİLLER (Header, Ekran, Tuşlar) --- */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .header-title { font-size: 0.8rem; color: var(--text-gray); font-weight: 600; letter-spacing: 1px; }
        .controls button { background: none; border: none; color: var(--text-gray); cursor: pointer; font-size: 1.1rem; margin-left: 8px; padding: 8px; border-radius: 8px; transition: 0.3s; }
        .controls button.active { color: var(--border-orange); background: rgba(254, 152, 0, 0.1); }

        .display-area { background-color: var(--screen-bg); border-radius: 16px; padding: 15px 20px; margin-bottom: 20px; text-align: right; height: 85px; display: flex; flex-direction: column; justify-content: space-between; border: 1px solid #334155; }
        .prev-op { color: var(--text-gray); font-size: 0.85rem; min-height: 1.2rem; }
        .curr-op { color: var(--text-white); font-size: 2.5rem; font-weight: 800; overflow-x: auto; white-space: nowrap; }
        .curr-op::-webkit-scrollbar { display: none; }

        .keys-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
        .calculator.scientific .keys-grid { grid-template-columns: repeat(6, 1fr); }

        button.key { height: 60px; border: none; border-radius: 14px; font-size: 1.3rem; font-weight: 700; color: white; cursor: pointer; background-color: var(--btn-dark); box-shadow: 0 4px 0 rgba(0,0,0,0.2); user-select: none; }
        button.key:active { transform: translateY(3px); box-shadow: none; }
        .key.dark { background-color: var(--btn-dark); }
        .key.orange { background-color: var(--btn-orange); }
        .key.red { background-color: var(--btn-red); }
        .key.blue { background-color: var(--btn-blue); }
        .key.gray { background-color: #475569; }
        .span-two { grid-column: span 2; }
        .sci-key { display: none; background-color: #475569; font-size: 0.9rem; }
        .calculator.scientific .sci-key { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .history-header { color: var(--text-gray); font-weight: bold; margin-bottom: 15px; display: flex; justify-content: space-between; padding-bottom: 10px; border-bottom: 1px solid #334155; }
        .history-list { flex: 1; overflow-y: auto; }
        .history-item { background: rgba(255,255,255,0.05); padding: 10px; border-radius: 8px; margin-bottom: 8px; cursor: pointer; }
        .hist-res { color: var(--btn-orange); font-weight: bold; text-align: right; font-size: 1.1rem; }

        /* --- MOBİL UYUMLULUK (Responsive) --- */
        @media (max-width: 768px) {
            body { 
                align-items: flex-end; /* Mobilde aşağı hizala */
                padding-bottom: 20px; 
            }
            
            .calculator { width: 95%; margin: 0 auto; margin-bottom: 20px; }
            .calculator.scientific { width: 95%; }

            .keys-grid { gap: 8px; }
            button.key { height: 55px; font-size: 1.2rem; }
            .calculator.scientific button.key { height: 45px; font-size: 1rem; }

            /* Mobilde Geçmiş Paneli (Alttan Çıkan Menü) */
            .history-panel {
                position: fixed; /* Ekrana sabitle */
                top: auto; 
                right: 0; 
                left: 0;
                bottom: 0;
                width: 100%; 
                height: 60vh; /* Ekranın %60'ı */
                border-radius: 24px 24px 0 0;
                z-index: 100; /* Her şeyin üstünde */
                
                /* Mobil Animasyon */
                transform: translateY(100%); /* Aşağıda gizli */
                opacity: 1;
                pointer-events: all;
                box-shadow: 0 -10px 30px rgba(0,0,0,0.5);
            }

            .history-panel.open {
                transform: translateY(0); /* Yukarı kayar */
            }
        }
    </style>
</head>
<body>

<div class="wrapper">
    <div class="calculator" id="calculator">
        <div class="header">
            <div class="header-title">HESAP MAKİNESİ</div>
            <div class="controls">
                <button onclick="toggleSound()" id="btnSound"><i class="fas fa-volume-up"></i></button>
                <button onclick="toggleScientific()" id="btnSci"><i class="fas fa-flask"></i></button>
                <button onclick="toggleHistory()" id="btnHist"><i class="fas fa-history"></i></button>
            </div>
        </div>

        <div class="display-area">
            <div class="prev-op" id="previous-operand"></div>
            <div class="curr-op" id="current-operand">0</div>
        </div>

        <div class="keys-grid">
            <button class="key sci-key" onclick="calcSci('sin')">sin</button>
            <button class="key sci-key" onclick="calcSci('cos')">cos</button>
            <button class="key red span-two" onclick="clearAll()">C</button>
            <button class="key gray" onclick="del()"><i class="fas fa-backspace"></i></button>
            <button class="key orange" onclick="setOp('÷')">÷</button>

            <button class="key sci-key" onclick="calcSci('tan')">tan</button>
            <button class="key sci-key" onclick="calcSci('sqrt')">√</button>
            <button class="key dark" onclick="append('7')">7</button>
            <button class="key dark" onclick="append('8')">8</button>
            <button class="key dark" onclick="append('9')">9</button>
            <button class="key orange" onclick="setOp('×')">×</button>

            <button class="key sci-key" onclick="calcSci('log')">log</button>
            <button class="key sci-key" onclick="calcSci('pi')">π</button>
            <button class="key dark" onclick="append('4')">4</button>
            <button class="key dark" onclick="append('5')">5</button>
            <button class="key dark" onclick="append('6')">6</button>
            <button class="key orange" onclick="setOp('-')">-</button>

            <button class="key sci-key" onclick="calcSci('pow')">x²</button>
            <button class="key sci-key" onclick="calcSci('e')">e</button>
            <button class="key dark" onclick="append('1')">1</button>
            <button class="key dark" onclick="append('2')">2</button>
            <button class="key dark" onclick="append('3')">3</button>
            <button class="key orange" onclick="setOp('+')">+</button>

            <button class="key sci-key" onclick="calcSci('(')">(</button>
            <button class="key sci-key" onclick="calcSci(')')">)</button>
            <button class="key dark span-two" onclick="append('0')">0</button>
            <button class="key dark" onclick="append('.')">.</button>
            <button class="key blue" onclick="compute()">=</button>
        </div>
    </div>

    <div class="history-panel" id="historyPanel">
        <div class="history-header">
            <span>İŞLEM GEÇMİŞİ</span>
            <span style="color:var(--btn-red); cursor:pointer;" onclick="toggleHistory()">Kapat <i class="fas fa-times"></i></span>
        </div>
        <div class="history-list" id="historyList">
            <div style="text-align:center; color:#64748b; font-size:0.8rem; margin-top:20px;">Henüz işlem yok</div>
        </div>
    </div>
</div>

<script>
    let curr = '0', prev = '', op = undefined, soundOn = true, historyData = [];
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function playClick() {
        if(!soundOn) return;
        if(audioCtx.state === 'suspended') audioCtx.resume();
        const o = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        o.type = 'triangle';
        o.frequency.setValueAtTime(300, audioCtx.currentTime);
        o.frequency.exponentialRampToValueAtTime(50, audioCtx.currentTime + 0.1);
        g.gain.setValueAtTime(0.1, audioCtx.currentTime);
        g.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
        o.connect(g); g.connect(audioCtx.destination);
        o.start(); o.stop(audioCtx.currentTime + 0.1);
    }

    function toggleSound() { soundOn = !soundOn; document.getElementById('btnSound').classList.toggle('active'); }
    function toggleScientific() { document.getElementById('calculator').classList.toggle('scientific'); document.getElementById('btnSci').classList.toggle('active'); }
    
    // Geçmiş Paneli Aç/Kapa
    function toggleHistory() { 
        document.getElementById('historyPanel').classList.toggle('open'); 
        document.getElementById('btnHist').classList.toggle('active'); 
    }

    function updateDisplay() {
        document.getElementById('current-operand').innerText = Number(curr).toLocaleString('tr-TR', {maximumFractionDigits: 10});
        document.getElementById('previous-operand').innerText = op ? `${Number(prev).toLocaleString('tr-TR')} ${op}` : '';
    }

    function append(n) { playClick(); if(n==='.' && curr.includes('.'))return; curr = curr==='0' && n!=='.' ? n : curr+n; updateDisplay(); }
    function setOp(o) { playClick(); if(curr==='')return; if(prev!=='')compute(); op=o; prev=curr; curr=''; updateDisplay(); }
    
    function calcSci(f) {
        playClick();
        let v = parseFloat(curr);
        if(isNaN(v) && f!=='pi' && f!=='e') return;
        let res = 0;
        switch(f) {
            case 'sin': res=Math.sin(v); break;
            case 'cos': res=Math.cos(v); break;
            case 'tan': res=Math.tan(v); break;
            case 'sqrt': res=Math.sqrt(v); break;
            case 'log': res=Math.log10(v); break;
            case 'pi': res=Math.PI; break;
            case 'e': res=Math.E; break;
            case 'pow': res=Math.pow(v,2); break;
        }
        addToHistory(`${f}(${Number(curr).toLocaleString()})`, res);
        curr = res.toString(); updateDisplay();
    }

    function compute() {
        playClick();
        let p=parseFloat(prev), c=parseFloat(curr), res=0;
        if(isNaN(p)||isNaN(c)) return;
        switch(op) {
            case '+': res=p+c; break;
            case '-': res=p-c; break;
            case '×': res=p*c; break;
            case '÷': res=p/c; break;
        }
        addToHistory(`${Number(prev).toLocaleString()} ${op} ${Number(curr).toLocaleString()}`, res);
        curr=res.toString(); op=undefined; prev=''; updateDisplay();
    }

    function clearAll() { playClick(); curr='0'; prev=''; op=undefined; updateDisplay(); }
    function del() { playClick(); curr=curr.toString().slice(0,-1); if(curr==='')curr='0'; updateDisplay(); }

    function addToHistory(exp, res) {
        historyData.unshift({exp, res});
        const list = document.getElementById('historyList');
        let html = '';
        historyData.forEach(item => {
            html += `<div class="history-item" onclick="loadHist('${item.res}')"><div style="color:#94a3b8; font-size:0.8rem;">${item.exp}=</div><div class="hist-res">${Number(item.res).toLocaleString('tr-TR')}</div></div>`;
        });
        list.innerHTML = html;
    }
    function loadHist(val) { 
        curr=val.toString(); 
        updateDisplay(); 
        // Mobilde paneli kapat, masaüstünde açık kalabilir
        if(window.innerWidth <= 768) {
            toggleHistory();
        }
    }
</script>
</body>
</html>
